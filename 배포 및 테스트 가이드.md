# Queue-Based Load Leveling í”„ë¡œì íŠ¸ ë°°í¬ ë° í…ŒìŠ¤íŠ¸ ê°€ì´ë“œ

## ğŸ“‹ ê°œìš”

ì´ ë¬¸ì„œëŠ” GitHubì—ì„œ í´ë¡ í•œ Queue-Based Load Leveling í”„ë¡œì íŠ¸(`https://github.com/xotlr333/queue-based-load-leveling`)ë¥¼ macOS í™˜ê²½ì˜ Minikubeì— ë°°í¬í•˜ê³ , ë¶€í•˜ í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜í–‰í•˜ëŠ” ì‹¤ë¬´ ê°€ì´ë“œì…ë‹ˆë‹¤.

## ğŸ¯ ìµœì¢… ëª©í‘œ

- âœ… GitHub í”„ë¡œì íŠ¸ë¥¼ Minikubeì— ì™„ì „ ë°°í¬
- âœ… RabbitMQ ê¸°ë°˜ ë©”ì‹œì§€ í ì‹œìŠ¤í…œ êµ¬ë™
- âœ… Producer/Consumer ì•„í‚¤í…ì²˜ ì‹¤í–‰
- âœ… ëª¨ë‹ˆí„°ë§ ìŠ¤ìœ„ì¹˜ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸
- âœ… ëŒ€ìš©ëŸ‰ ë¶€í•˜ í…ŒìŠ¤íŠ¸ ìˆ˜í–‰ ë° íŒ¨í„´ íš¨ê³¼ ê²€ì¦

## ğŸ› ï¸ 1ë‹¨ê³„: í™˜ê²½ ì¤€ë¹„

### í•„ìˆ˜ ë„êµ¬ ì„¤ì¹˜

```bash
# Homebrewë¡œ í•„ìˆ˜ ë„êµ¬ ì„¤ì¹˜
brew install --cask docker          # Docker Desktop
brew install minikube kubectl helm watch

# Python í™˜ê²½ ì„¤ì •
python3 -m venv queue-pattern-env
source queue-pattern-env/bin/activate
```

### í”„ë¡œì íŠ¸ í´ë¡ 

```bash
# GitHubì—ì„œ í”„ë¡œì íŠ¸ í´ë¡ 
git clone https://github.com/xotlr333/queue-based-load-leveling.git
cd queue-based-load-leveling

# í”„ë¡œì íŠ¸ êµ¬ì¡° í™•ì¸
ls -la
cat README.md
```

### Python ì˜ì¡´ì„± ì„¤ì¹˜

```bash
# í”„ë¡œì íŠ¸ ì˜ì¡´ì„± ì„¤ì¹˜
pip install -r requirements.txt

# ë¶€í•˜ í…ŒìŠ¤íŠ¸ìš© ì¶”ê°€ íŒ¨í‚¤ì§€ ì„¤ì¹˜
pip install aiohttp psutil
```

## ğŸš€ 2ë‹¨ê³„: Minikube í´ëŸ¬ìŠ¤í„° êµ¬ì„±

### Minikube ì‹œì‘

```bash
# Minikube ì‹œì‘ (macOS ìµœì í™” ì„¤ì •)
minikube start \
  --memory=8192 \
  --cpus=4 \
  --disk-size=20g \
  --driver=docker

# í•„ìˆ˜ ì• ë“œì˜¨ í™œì„±í™”
minikube addons enable ingress
minikube addons enable metrics-server

# Docker í™˜ê²½ì„ Minikubeì™€ ì—°ê²°
eval $(minikube docker-env)

# ìƒíƒœ í™•ì¸
minikube status
kubectl get nodes
```

## ğŸ“¦ 3ë‹¨ê³„: RabbitMQ ì„¤ì¹˜

### ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ë° RabbitMQ ì„¤ì¹˜

```bash
# ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ìƒì„±
kubectl create namespace bss-queue-system

# Helmìœ¼ë¡œ RabbitMQ ì„¤ì¹˜
helm repo add bitnami https://charts.bitnami.com/bitnami
helm repo update

helm install rabbitmq bitnami/rabbitmq \
  --namespace bss-queue-system \
  --set auth.username=admin \
  --set auth.password=secretpassword \
  --set persistence.enabled=true \
  --set persistence.size=10Gi \
  --wait

# ì„¤ì¹˜ í™•ì¸
kubectl get pods -n bss-queue-system
```

## ğŸ³ 4ë‹¨ê³„: ì• í”Œë¦¬ì¼€ì´ì…˜ ì´ë¯¸ì§€ ë¹Œë“œ

### Docker ì´ë¯¸ì§€ ë¹Œë“œ

```bash
# Minikube Docker í™˜ê²½ í™•ì¸
eval $(minikube docker-env)

# Producer ì´ë¯¸ì§€ ë¹Œë“œ
docker build -f docker/Dockerfile.producer -t bss-producer:latest .

# Consumer ì´ë¯¸ì§€ ë¹Œë“œ (ê° ì„œë¹„ìŠ¤ë³„)
docker build -f docker/Dockerfile.consumer -t subscription-processor:latest \
  --build-arg SERVICE_TYPE=subscription .

docker build -f docker/Dockerfile.consumer -t mnp-processor:latest \
  --build-arg SERVICE_TYPE=mnp .

docker build -f docker/Dockerfile.consumer -t change-processor:latest \
  --build-arg SERVICE_TYPE=change .

docker build -f docker/Dockerfile.consumer -t termination-processor:latest \
  --build-arg SERVICE_TYPE=termination .

# ë¹Œë“œëœ ì´ë¯¸ì§€ í™•ì¸
docker images | grep -E "(bss-producer|processor)"
```

## âš™ï¸ 5ë‹¨ê³„: Kubernetes ë¦¬ì†ŒìŠ¤ ë°°í¬

### ConfigMap ë°°í¬

```bash
# í”„ë¡œì íŠ¸ì˜ Kubernetes ë§¤ë‹ˆí˜ìŠ¤íŠ¸ ë°°í¬
kubectl apply -f k8s/namespace.yaml
kubectl apply -f k8s/configmap/
```

### Producer ë°°í¬

```bash
# Producer ë° Service ë°°í¬
kubectl apply -f k8s/producer/

# ë°°í¬ ìƒíƒœ í™•ì¸
kubectl get deployment bss-producer -n bss-queue-system
kubectl get pods -l app=bss-producer -n bss-queue-system
```

### Consumer ë°°í¬

```bash
# ëª¨ë“  Consumer ì„œë¹„ìŠ¤ ë°°í¬
kubectl apply -f k8s/consumer/

# HPA (ìë™ ìŠ¤ì¼€ì¼ë§) í™•ì¸
kubectl get hpa -n bss-queue-system

# Consumer Pod ìƒíƒœ í™•ì¸
kubectl get pods -l app=subscription-processor -n bss-queue-system
kubectl get pods -l app=mnp-processor -n bss-queue-system
```

## ğŸ”§ 6ë‹¨ê³„: í¬íŠ¸ í¬ì›Œë”© ì„¤ì •

### í¬íŠ¸ í¬ì›Œë”© ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰

```bash
# í”„ë¡œì íŠ¸ì— í¬í•¨ëœ í¬íŠ¸ í¬ì›Œë”© ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
chmod +x scripts/setup-port-forwarding.sh
./scripts/setup-port-forwarding.sh

# ë˜ëŠ” ìˆ˜ë™ìœ¼ë¡œ í¬íŠ¸ í¬ì›Œë”©
kubectl port-forward svc/rabbitmq 15672:15672 -n bss-queue-system &
kubectl port-forward svc/bss-producer-service 8000:8000 -n bss-queue-system &
```

### í¬íŠ¸ ì¶©ëŒ í•´ê²° (í•„ìš”ì‹œ)

```bash
# 8000 í¬íŠ¸ ì‚¬ìš© í”„ë¡œì„¸ìŠ¤ í™•ì¸
lsof -i :8000

# 8000 í¬íŠ¸ ì‚¬ìš© í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ
lsof -ti :8000 | xargs kill

# í¬íŠ¸ í¬ì›Œë”© ì¬ì‹œì‘
kubectl port-forward svc/bss-producer-service 8000:8000 -n bss-queue-system &
```

## âœ… 7ë‹¨ê³„: ë°°í¬ ìƒíƒœ í™•ì¸

### ì „ì²´ ì‹œìŠ¤í…œ ìƒíƒœ ì ê²€

```bash
# ëª¨ë“  ë¦¬ì†ŒìŠ¤ ìƒíƒœ í™•ì¸
kubectl get all -n bss-queue-system

# Pod ë¡œê·¸ í™•ì¸
kubectl logs -l app=bss-producer -n bss-queue-system
kubectl logs -l app=subscription-processor -n bss-queue-system

# ì„œë¹„ìŠ¤ ì—”ë“œí¬ì¸íŠ¸ í™•ì¸
kubectl get endpoints -n bss-queue-system
```

### API ì—°ê²° í…ŒìŠ¤íŠ¸

```bash
# Producer API Health Check
curl http://localhost:8000/health

# ëª¨ë‹ˆí„°ë§ ìƒíƒœ í™•ì¸
curl http://localhost:8000/api/monitoring/status

# ê¸°ë³¸ ë©”ì‹œì§€ ì „ì†¡ í…ŒìŠ¤íŠ¸
curl -X POST http://localhost:8000/api/message \
  -H "Content-Type: application/json" \
  -d '{
    "íƒ€ì…": "SUBSCRIPTION",
    "ë‚´ìš©": "í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€",
    "ì†ì„±ë“¤": {"í…ŒìŠ¤íŠ¸": true}
  }'
```

## ğŸ§ª 8ë‹¨ê³„: ë¶€í•˜ í…ŒìŠ¤íŠ¸ ì‹¤í–‰

### ê¸°ë³¸ ë¶€í•˜ í…ŒìŠ¤íŠ¸

```bash
# í”„ë¡œì íŠ¸ì— í¬í•¨ëœ ë¶€í•˜ í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
python scripts/basic_load_test.py

# ë˜ëŠ” ì‹¤í—˜ ëª¨ë“ˆ ì‚¬ìš©
python -m src.experiments.load_generator --requests 1000 --concurrency 50
```

### ëŒ€ìš©ëŸ‰ ë¶€í•˜ í…ŒìŠ¤íŠ¸

```bash
# ëŒ€ìš©ëŸ‰ ë¶€í•˜ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
python scripts/high_volume_test.py

# 10,000ê°œ ìš”ì²­ í…ŒìŠ¤íŠ¸
python -m src.experiments.load_generator \
  --requests 10000 \
  --concurrency 200 \
  --test-type burst
```

### ëª¨ë‹ˆí„°ë§ê³¼ í•¨ê»˜ ë¶€í•˜ í…ŒìŠ¤íŠ¸

```bash
# ë³„ë„ í„°ë¯¸ë„ì—ì„œ ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§ ì‹œì‘
python scripts/monitor_system.py

# ë©”ì¸ í„°ë¯¸ë„ì—ì„œ ë¶€í•˜ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
python scripts/comprehensive_load_test.py
```

## ğŸ“Š 9ë‹¨ê³„: ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§

### Pod ë¦¬ì†ŒìŠ¤ ëª¨ë‹ˆí„°ë§

```bash
# ì‹¤ì‹œê°„ Pod ìƒíƒœ ëª¨ë‹ˆí„°ë§ (macOS í˜¸í™˜)
watch -n 3 "kubectl get pods -n bss-queue-system"

# ë˜ëŠ” Python ëª¨ë‹ˆí„°ë§ ìŠ¤í¬ë¦½íŠ¸ ì‚¬ìš©
python scripts/pod_monitor.py

# íŠ¹ì • Pod ì§‘ì¤‘ ëª¨ë‹ˆí„°ë§
python scripts/pod_monitor.py producer
python scripts/pod_monitor.py subscription
```

### ì‹œìŠ¤í…œ ë¦¬ì†ŒìŠ¤ ëª¨ë‹ˆí„°ë§

```bash
# CPU/ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ì‹¤ì‹œê°„ í™•ì¸
kubectl top pods -n bss-queue-system

# ìë™ ìŠ¤ì¼€ì¼ë§ ìƒíƒœ ëª¨ë‹ˆí„°ë§
kubectl get hpa -n bss-queue-system --watch
```

## ğŸ¯ 10ë‹¨ê³„: ëª¨ë‹ˆí„°ë§ ìŠ¤ìœ„ì¹˜ í…ŒìŠ¤íŠ¸

### ëª¨ë‹ˆí„°ë§ ON/OFF ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸

```bash
# í˜„ì¬ ëª¨ë‹ˆí„°ë§ ìƒíƒœ í™•ì¸
curl http://localhost:8000/api/monitoring/status

# ëª¨ë‹ˆí„°ë§ í† ê¸€ (ì¼œê¸°/ë„ê¸°)
curl -X POST http://localhost:8000/api/monitoring/toggle

# ëª¨ë‹ˆí„°ë§ ëª…ì‹œì  ì œì–´
curl -X POST http://localhost:8000/api/monitoring/enable   # ì¼œê¸°
curl -X POST http://localhost:8000/api/monitoring/disable  # ë„ê¸°
```

### ëª¨ë‹ˆí„°ë§ ì„±ëŠ¥ ì˜í–¥ ì¸¡ì •

```bash
# ëª¨ë‹ˆí„°ë§ ON/OFF ì„±ëŠ¥ ë¹„êµ í…ŒìŠ¤íŠ¸
python scripts/monitoring_performance_test.py

# ê²°ê³¼ ë¶„ì„
python scripts/analyze_monitoring_impact.py
```

## ğŸ”¬ 11ë‹¨ê³„: Queue-Based Load Leveling íŒ¨í„´ ê²€ì¦

### íŒ¨í„´ íš¨ê³¼ ê²€ì¦ í…ŒìŠ¤íŠ¸

```bash
# ê¸‰ì¦ ë¶€í•˜ íŒ¨í„´ í…ŒìŠ¤íŠ¸ (ë¶€í•˜ í‰í™œí™” íš¨ê³¼ í™•ì¸)
python -m src.experiments.pattern_validator \
  --test-type burst_leveling \
  --burst-size 5000 \
  --duration 120

# ì‹œìŠ¤í…œ ì•ˆì •ì„± í…ŒìŠ¤íŠ¸
python -m src.experiments.pattern_validator \
  --test-type stability \
  --duration 300 \
  --sustained-load 100

# ìë™ ìŠ¤ì¼€ì¼ë§ ê²€ì¦
python -m src.experiments.pattern_validator \
  --test-type auto_scaling \
  --target-cpu 80
```

### ì¢…í•© íŒ¨í„´ ê²€ì¦

```bash
# ëª¨ë“  íŒ¨í„´ íš¨ê³¼ë¥¼ ì¢…í•©ì ìœ¼ë¡œ ê²€ì¦
python scripts/comprehensive_pattern_test.py

# ê²€ì¦ ë³´ê³ ì„œ ìƒì„±
python scripts/generate_validation_report.py
```

## ğŸ“ˆ 12ë‹¨ê³„: ì„±ëŠ¥ ê²°ê³¼ ë¶„ì„

### ëŒ€ì‹œë³´ë“œ ì ‘ê·¼

```bash
# RabbitMQ ê´€ë¦¬ UI ì ‘ì†
echo "RabbitMQ Management: http://localhost:15672"
echo "Username: admin, Password: secretpassword"

# Kubernetes ëŒ€ì‹œë³´ë“œ ì‹¤í–‰
minikube dashboard

# Producer API ë¬¸ì„œ ì ‘ì†
echo "API Docs: http://localhost:8000/docs"
```

### ë¡œê·¸ ë° ë©”íŠ¸ë¦­ ë¶„ì„

```bash
# ì‹¤ì‹œê°„ ë¡œê·¸ í™•ì¸
kubectl logs -f -l app=bss-producer -n bss-queue-system
kubectl logs -f -l app=subscription-processor -n bss-queue-system

# ë©”íŠ¸ë¦­ ìˆ˜ì§‘ ê²°ê³¼ í™•ì¸
python scripts/collect_metrics.py --duration 600  # 10ë¶„ê°„ ìˆ˜ì§‘

# ì„±ëŠ¥ ë¶„ì„ ë¦¬í¬íŠ¸ ìƒì„±
python scripts/performance_analysis.py
```

## ğŸ§¹ 13ë‹¨ê³„: ì •ë¦¬ ë° í´ë¦°ì—…

### ì‹œìŠ¤í…œ ì •ë¦¬

```bash
# í¬íŠ¸ í¬ì›Œë”© ì¢…ë£Œ
pkill -f "kubectl port-forward"

# ë°°í¬ëœ ì• í”Œë¦¬ì¼€ì´ì…˜ ì œê±°
kubectl delete namespace bss-queue-system

# RabbitMQ ì œê±°
helm uninstall rabbitmq -n bss-queue-system

# Minikube ì •ì§€ (ì„ íƒì )
minikube stop

# Minikube ì™„ì „ ì‚­ì œ (ì„ íƒì )
minikube delete
```

## ğŸ¯ ì„±ê³µ ê¸°ì¤€ ë° ê²€ì¦ ì²´í¬ë¦¬ìŠ¤íŠ¸

### ë°°í¬ ì„±ê³µ ê¸°ì¤€

- [ ] ëª¨ë“  Podê°€ Running ìƒíƒœ
- [ ] Producer API Health Check ì‘ë‹µ (200 OK)
- [ ] RabbitMQ ê´€ë¦¬ UI ì ‘ì† ê°€ëŠ¥
- [ ] Consumer Podë“¤ì´ ë©”ì‹œì§€ ì²˜ë¦¬ ë¡œê·¸ ì¶œë ¥
- [ ] HPAê°€ ì •ìƒì ìœ¼ë¡œ êµ¬ì„±ë¨

### ë¶€í•˜ í…ŒìŠ¤íŠ¸ ì„±ê³µ ê¸°ì¤€

- [ ] 1,000ê°œ ìš”ì²­ ì²˜ë¦¬ ì„±ê³µë¥  95% ì´ìƒ
- [ ] 10,000ê°œ ìš”ì²­ ì²˜ë¦¬ ì™„ë£Œ
- [ ] í‰ê·  ì‘ë‹µ ì‹œê°„ 2ì´ˆ ì´ë‚´
- [ ] ì‹œìŠ¤í…œ ì•ˆì •ì„± ìœ ì§€ (Pod ì¬ì‹œì‘ ì—†ìŒ)
- [ ] ìë™ ìŠ¤ì¼€ì¼ë§ ë™ì‘ í™•ì¸

### íŒ¨í„´ ê²€ì¦ ì„±ê³µ ê¸°ì¤€

- [ ] ë¶€í•˜ í‰í™œí™” íš¨ê³¼ í™•ì¸ (ê¸‰ì¦ â†’ ì•ˆì •ì  ì²˜ë¦¬)
- [ ] í ë²„í¼ë§ íš¨ê³¼ ì¸¡ì •
- [ ] ëª¨ë‹ˆí„°ë§ ON/OFF ì„±ëŠ¥ ì°¨ì´ < 15%
- [ ] Consumer ìŠ¤ì¼€ì¼ë§ ì •ìƒ ë™ì‘
- [ ] ë©”ì‹œì§€ ì†ì‹¤ë¥  1% ë¯¸ë§Œ

## ğŸ’¡ ë¬¸ì œ í•´ê²° ê°€ì´ë“œ

### ì¼ë°˜ì ì¸ ë¬¸ì œë“¤

**Podê°€ ì‹œì‘ë˜ì§€ ì•ŠëŠ” ê²½ìš°:**
```bash
kubectl describe pod <pod-name> -n bss-queue-system
kubectl logs <pod-name> -n bss-queue-system
```

**í¬íŠ¸ í¬ì›Œë”© ì‹¤íŒ¨:**
```bash
lsof -i :8000
pkill -f "kubectl port-forward"
```

**ì´ë¯¸ì§€ Pull ì˜¤ë¥˜:**
```bash
eval $(minikube docker-env)
docker images | grep bss
```

**RabbitMQ ì—°ê²° ì‹¤íŒ¨:**
```bash
kubectl get services -n bss-queue-system
kubectl port-forward svc/rabbitmq 15672:15672 -n bss-queue-system
```

## ğŸ“ ì¶”ê°€ ë¦¬ì†ŒìŠ¤

- **í”„ë¡œì íŠ¸ GitHub**: https://github.com/xotlr333/queue-based-load-leveling
- **Minikube ë¬¸ì„œ**: https://minikube.sigs.k8s.io/docs/
- **RabbitMQ ë¬¸ì„œ**: https://www.rabbitmq.com/documentation.html
- **Kubernetes ë¬¸ì„œ**: https://kubernetes.io/docs/

---

**ì´ ê°€ì´ë“œë¥¼ í†µí•´ GitHub í”„ë¡œì íŠ¸ë¥¼ ì„±ê³µì ìœ¼ë¡œ ë°°í¬í•˜ê³  Queue-Based Load Leveling íŒ¨í„´ì˜ íš¨ê³¼ë¥¼ ì‹¤ì¦í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.**